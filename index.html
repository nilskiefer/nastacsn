<!DOCTYPE html>
<html>
  <head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-QEFD7PPEXG"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-QEFD7PPEXG');
</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      html,
      body {
        height: 100%;
        margin: 0;
        background-image: url("https://media4.giphy.com/media/oabMc4R2hZmz6/giphy.webp?cid=ecf05e47rlxe3sba0pce2jtq0newdahdxfjrjda40uwwkuj2&rid=giphy.webp");
        background-repeat: no-repeat;
        background-position: left bottom;
      }
      div.container4 {
        height: 100%;
      }
      div.container4 p {
        margin: 0;
        font-size: xx-large;
        position: absolute;
        top: 50%;
        left: 50%;
        margin-right: -50%;
        transform: translate(-50%, -50%);
      }
    </style>
  </head>
  <body>
    <div class="container4">
      <p id="bruh" class="bruh"></p>
    </div>

    <script type="text/javascript">
      const animateCSS = (element, animation, prefix = "animate__") =>
        // We create a Promise and return it
        new Promise((resolve, reject) => {
          const animationName = `${prefix}${animation}`;
          const node = document.querySelector(element);

          node.classList.add(`${prefix}animated`, animationName);

          // When the animation ends, we clean the classes and resolve the Promise
          function handleAnimationEnd(event) {
            event.stopPropagation();
            node.classList.remove(`${prefix}animated`, animationName);
            resolve("Animation ended");
          }

          node.addEventListener("animationend", handleAnimationEnd, {
            once: true,
          });
        });

      document.getElementById("bruh").innerHTML = dhm(GetMoment() - Date.now());
      function UpdateDate() {
        console.log("updated");
        document.getElementById("bruh").innerHTML = dhm(
          GetMoment() - Date.now()
        );
        animateCSS(".container4", "pulse");
      }

      var ONE_MINUTE = 60 * 1000;
      setInterval(UpdateDate, ONE_MINUTE);

      function repeatEvery(func, interval) {
        // Check current time and calculate the delay until next interval
        var now = new Date(),
          delay = interval - (now % interval);

        function start() {
          // Execute function now...
          func();
          // ... and every interval
          setInterval(func, interval);
        }

        // Delay execution until it's an even interval
        setTimeout(start, delay);
      }
      UpdateDate(UpdateDate, ONE_MINUTE);
      function dhm(ms) {
        weeks = Math.floor(ms / (7 * 24 * 60 * 60 * 1000));
        weeksms = ms % (7 * 24 * 60 * 60 * 1000);
        days = Math.floor(weeksms / (24 * 60 * 60 * 1000));
        daysms = ms % (24 * 60 * 60 * 1000);
        hours = Math.floor(daysms / (60 * 60 * 1000));
        hoursms = ms % (60 * 60 * 1000);
        minutes = Math.floor(hoursms / (60 * 1000));
        if (weeks > 0) {
          weeks += " veckor, <br>";
        }
        if (days > 0) {
          days += " dagar, <br>";
        }
        if (hours > 0) {
          hours += " timmar och <br>";
        }
        return (
          "CSN kommer om <br>" + weeks + days + hours + minutes + " minuter"
        );
      }
      // Set the date for december. You can use this for any month.
      // Get array of business days for the month
      function GetMoment() {
        var moment;
        moment =
          typeof require !== "undefined" && require !== null && !require.amd
            ? require("moment")
            : this.moment;

        moment.fn.isHoliday = function () {
          var locale = this.localeData();

          if (locale._holidays) {
            if (
              locale._holidays.indexOf(this.format(locale._holidayFormat)) >= 0
            )
              return true;
          }

          return false;
        };

        moment.fn.isBusinessDay = function () {
          if (this.day() === 0 || this.day() === 6) return false;
          if (this.isHoliday()) return false;
          return true;
        };

        moment.fn.businessDaysIntoMonth = function () {
          var businessDay = this.isBusinessDay()
            ? this
            : this.prevBusinessDay();
          var monthBusinessDays = businessDay.monthBusinessDays();
          var businessDaysIntoMonth;
          monthBusinessDays.map(function (day, index) {
            if (day.format("M/DD/YY") === businessDay.format("M/DD/YY"))
              businessDaysIntoMonth = index + 1;
          });

          return businessDaysIntoMonth;
        };

        moment.fn.businessDiff = function (param) {
          param = moment(param);
          var signal = param.unix() < this.unix() ? 1 : -1;
          var start = moment.min(param, this).clone();
          var end = moment.max(param, this).clone();
          var start_offset = start.day() - 7;
          var end_offset = end.day();

          var end_sunday = end.clone().subtract("d", end_offset);
          var start_sunday = start.clone().subtract("d", start_offset);
          var weeks = end_sunday.diff(start_sunday, "days") / 7;

          start_offset = Math.abs(start_offset);
          if (start_offset == 7) {
            start_offset = 5;
          } else if (start_offset == 1) {
            start_offset = 0;
          } else {
            start_offset -= 2;
          }

          if (end_offset == 6) {
            end_offset--;
          }

          return signal * (weeks * 5 + start_offset + end_offset);
        };

        moment.fn.businessAdd = function (days) {
          var signal = days < 0 ? -1 : 1;
          var daysRemaining = Math.abs(days);
          var d = this.clone();
          while (daysRemaining) {
            d.add(signal, "d");
            if (d.isBusinessDay()) {
              daysRemaining--;
            }
          }
          return d;
        };

        moment.fn.businessSubtract = function (days) {
          return this.businessAdd(-days);
        };

        moment.fn.nextBusinessDay = function () {
          var loop = 1;
          var limit = 7;
          while (loop < limit) {
            if (this.add(1, "d").isBusinessDay()) {
              break;
            }
            loop++;
          }
          return this;
        };

        moment.fn.prevBusinessDay = function () {
          var loop = 1;
          var limit = 7;
          while (loop < limit) {
            if (this.subtract(1, "d").isBusinessDay()) {
              break;
            }
            loop++;
          }
          return this;
        };

        moment.fn.monthBusinessDays = function () {
          var me = this.clone();
          var day = me.clone().startOf("month");
          var end = me.clone().endOf("month");
          var daysArr = [];
          var done = false;
          while (!done) {
            if (day.isBusinessDay()) {
              daysArr.push(day.clone());
            }
            if (end.diff(day.add(1, "d")) < 0) {
              done = true;
            }
          }
          return daysArr;
        };

        moment.fn.monthNaturalDays = function (fromToday) {
          var me = this.clone();
          var day = fromToday ? me.clone() : me.clone().startOf("month");
          var end = me.clone().endOf("month");
          var daysArr = [];
          var done = false;
          while (!done) {
            daysArr.push(day.clone());
            if (end.diff(day.add(1, "d")) < 0) {
              done = true;
            }
          }
          return daysArr;
        };

        moment.fn.monthBusinessWeeks = function (fromToday) {
          var me = this.clone();
          var day = fromToday ? me.clone() : me.clone().startOf("month");
          var end = me.clone().endOf("month");
          var weeksArr = [];
          var daysArr = [];
          var done = false;

          while (!done) {
            if (day.day() >= 1 && day.day() < 6) {
              daysArr.push(day.clone());
            }
            if (day.day() === 5) {
              weeksArr.push(daysArr);
              daysArr = [];
            }
            if (end.diff(day.add(1, "d")) < 0) {
              if (daysArr.length < 5) {
                weeksArr.push(daysArr);
              }
              done = true;
            }
          }
          return weeksArr;
        };

        moment.fn.monthNaturalWeeks = function (fromToday) {
          var me = this.clone();
          var day = fromToday ? me.clone() : me.clone().startOf("month");
          var end = me.clone().endOf("month");
          var weeksArr = [];
          var daysArr = [];
          var done = false;

          while (!done) {
            daysArr.push(day.clone());
            if (day.day() === 6) {
              weeksArr.push(daysArr);
              daysArr = [];
            }
            if (end.diff(day.add(1, "d")) < 0) {
              if (daysArr.length < 7) {
                weeksArr.push(daysArr);
              }
              done = true;
            }
          }
          return weeksArr;
        };
        var d = new Date();

        var businessDays = moment(
          d.getDate() + "-" + (d.getMonth() + 1) + "-" + d.getFullYear(),
          "DD-MM-YYYY"
        ).monthBusinessDays();
        // Get last business day from the array
        var lastBusinessDay = businessDays[businessDays.length - 1]._d;
        return lastBusinessDay;
      }
    </script>

  </body>
</html>
